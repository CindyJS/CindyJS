<!DOCTYPE html>
<html>

<head>
<title>Cindy JS Example</title>
<meta charset="UTF-8">
<script type="text/javascript" src="../build/js/Cindy.js"></script>
<script type="text/javascript" src="../build/js/CindyGL.js"></script>

<script type="text/javascript">
var a = "test";
createCindy.registerPlugin(1,"testing",function(api){
  console.log("loading plugin testing");
  a = api;
  
  api.defineFunction("parseexpr",1,function(args,modifs){
    console.log("run parse function");
    console.log(JSON.stringify(args[0]));
    //console.log("");
    console.log(JSON.stringify(api.getMyfunctions()));
  });
});
</script>

<script id="csinit" type="text/x-cindyscript">
use("testing");
use("CindyGL");

f(z, c) := z*z + c;
z = 0;

mandle(c) := (
  z = 0; //global variable
  repeat(17,
    z = f(z, c);
    //if(abs(z)>5, z=5)
  );
  if(abs(z) < 5,
    hue(arctan2(re(z), im(z))/pi),
    (0,0,0)
  )
);



parseexpr(mandle(complex(#)));
//compile(mandle(complex(#)));
parseexpr(sin((#*#)));
compile(sin((#*#)));
x = 2;
parseexpr(if(4>3, .2, 1));

</script>
<script id="csmove" type="text/x-cindyscript">
drawtext(A, z);
A.color = mandle(complex(A.xy));
</script>
<script type="text/javascript">

            var gslp=[
                      {name:"A", kind:"P", type:"Free", pos:[0,0,1]}
                      ];
createCindy({
  canvasname: "cindy",
  scripts: "cs*",
  geometry:gslp,
  defaultAppearance: { },
});


</script>
</head>

<body style="font-family:Arial;">
  <pre>
    <canvas id="cindy" width="500" height="500"
            style="border:2px solid black"></canvas>
  </pre>
</body>

</html>
