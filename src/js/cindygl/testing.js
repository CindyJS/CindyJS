var nada; //instead of Plugin.js
var myfunctions;

//DEBUG; @TODO: Remove
console.log(next);

console.log(issubtypeof(type.float, type.int));
console.log(issubtypeof(type.int, type.float));


console.log(lca(type.int, type.float));
console.log(lca(type.float, type.int));
console.log(lca(type.int, type.vec2));


console.log(matchSignature("arctan2", [type.complex,type.float]));


console.log(matchSignature("if", [type.bool, type.int, type.float]));
console.log(matchSignature("if", [type.bool, type.vec2, type.float]));
console.log(matchSignature("if", [type.bool, type.int]));
console.log(matchSignature("+", [type.int, type.int]));






/**
 * TOY-Example; @TODO: remove
 */


//myfunctions = 
//myfunctions = {"#drawgrid$1":{"oper":"#drawgrid$1","body":{"ctype":"infix","oper":";","args":[{"ctype":"infix","oper":";","args":[{"ctype":"infix","oper":";","args":[{"ctype":"infix","oper":";","args":[{"ctype":"infix","oper":";","args":[{"ctype":"infix","oper":";","args":[{"ctype":"infix","oper":";","args":[{"ctype":"infix","oper":";","args":[{"ctype":"infix","oper":";","args":[{"ctype":"infix","oper":";","args":[{"ctype":"infix","oper":";","args":[{"ctype":"function","oper":"regional$7","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"b"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"xmin"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"xmax"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ymin"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ymax"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"nx"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ny"}],"modifs":{}},{"ctype":"infix","oper":"=","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"b"},{"ctype":"function","oper":"screenbounds$0","args":[],"modifs":{}}]}]},{"ctype":"infix","oper":"=","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"xmin"},{"ctype":"infix","oper":"-","args":[{"ctype":"infix","oper":"_","args":[{"ctype":"infix","oper":"_","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"b"},{"ctype":"number","value":{"real":4,"imag":0}}]},{"ctype":"number","value":{"real":1,"imag":0}}]},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]}]}]},{"ctype":"infix","oper":"=","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"xmax"},{"ctype":"infix","oper":"+","args":[{"ctype":"infix","oper":"_","args":[{"ctype":"infix","oper":"_","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"b"},{"ctype":"number","value":{"real":2,"imag":0}}]},{"ctype":"number","value":{"real":1,"imag":0}}]},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]}]}]},{"ctype":"infix","oper":"=","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ymin"},{"ctype":"infix","oper":"-","args":[{"ctype":"infix","oper":"_","args":[{"ctype":"infix","oper":"_","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"b"},{"ctype":"number","value":{"real":4,"imag":0}}]},{"ctype":"number","value":{"real":2,"imag":0}}]},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]}]}]},{"ctype":"infix","oper":"=","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ymax"},{"ctype":"infix","oper":"+","args":[{"ctype":"infix","oper":"_","args":[{"ctype":"infix","oper":"_","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"b"},{"ctype":"number","value":{"real":2,"imag":0}}]},{"ctype":"number","value":{"real":2,"imag":0}}]},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]}]}]},{"ctype":"infix","oper":"=","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"nx"},{"ctype":"function","oper":"round$1","args":[{"ctype":"infix","oper":"/","args":[{"ctype":"infix","oper":"-","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"xmax"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"xmin"}]},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]}],"modifs":{}}]}]},{"ctype":"infix","oper":"=","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ny"},{"ctype":"function","oper":"round$1","args":[{"ctype":"infix","oper":"/","args":[{"ctype":"infix","oper":"-","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ymax"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ymin"}]},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]}],"modifs":{}}]}]},{"ctype":"infix","oper":"=","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"xmin"},{"ctype":"infix","oper":"*","args":[{"ctype":"function","oper":"floor$1","args":[{"ctype":"infix","oper":"/","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"xmin"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]}],"modifs":{}},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]}]}]},{"ctype":"infix","oper":"=","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ymin"},{"ctype":"infix","oper":"*","args":[{"ctype":"function","oper":"floor$1","args":[{"ctype":"infix","oper":"/","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ymin"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]}],"modifs":{}},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]}]}]},{"ctype":"function","oper":"repeat$3","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"nx"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"x"},{"ctype":"infix","oper":";","args":[{"ctype":"function","oper":"draw$2","args":[{"ctype":"function","oper":"genList","args":[{"ctype":"infix","oper":"+","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"xmin"},{"ctype":"infix","oper":"*","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"x"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]}]},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ymin"}],"modifs":{}},{"ctype":"function","oper":"genList","args":[{"ctype":"infix","oper":"+","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"xmin"},{"ctype":"infix","oper":"*","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"x"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]}]},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ymax"}],"modifs":{}}],"modifs":{"color":{"ctype":"infix","oper":"*","args":[{"ctype":"function","oper":"genList","args":[{"ctype":"number","value":{"real":1,"imag":0}},{"ctype":"number","value":{"real":1,"imag":0}},{"ctype":"number","value":{"real":1,"imag":0}}],"modifs":{}},{"value":{"real":0.9,"imag":0},"ctype":"number"}]},"size":{"ctype":"number","value":{"real":1,"imag":0}}}},{"ctype":"void"}]}],"modifs":{}}]},{"ctype":"function","oper":"repeat$3","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ny"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"y"},{"ctype":"infix","oper":";","args":[{"ctype":"function","oper":"draw$2","args":[{"ctype":"function","oper":"genList","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"xmin"},{"ctype":"infix","oper":"+","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ymin"},{"ctype":"infix","oper":"*","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"y"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]}]}],"modifs":{}},{"ctype":"function","oper":"genList","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"xmax"},{"ctype":"infix","oper":"+","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ymin"},{"ctype":"infix","oper":"*","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"y"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]}]}],"modifs":{}}],"modifs":{"color":{"ctype":"infix","oper":"*","args":[{"ctype":"function","oper":"genList","args":[{"ctype":"number","value":{"real":1,"imag":0}},{"ctype":"number","value":{"real":1,"imag":0}},{"ctype":"number","value":{"real":1,"imag":0}}],"modifs":{}},{"value":{"real":0.9,"imag":0},"ctype":"number"}]},"size":{"ctype":"number","value":{"real":1,"imag":0}}}},{"ctype":"void"}]}],"modifs":{}}]},"arglist":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]},"f$2":{"oper":"f$2","body":{"ctype":"infix","oper":"+","args":[{"ctype":"infix","oper":"*","args":[{"ctype":"variable","stack":[{"ctype":"number","value":{"real":-5.269207787345638e+72,"imag":6.672049355733727e+72}}],"name":"z"},{"ctype":"variable","stack":[{"ctype":"number","value":{"real":-5.269207787345638e+72,"imag":6.672049355733727e+72}}],"name":"z"}]},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"c"}]},"arglist":[{"ctype":"variable","stack":[{"ctype":"number","value":{"real":-5.269207787345638e+72,"imag":6.672049355733727e+72}}],"name":"z"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"c"}]},"mandle$1":{"oper":"mandle$1","body":{"ctype":"infix","oper":";","args":[{"ctype":"infix","oper":";","args":[{"ctype":"infix","oper":"=","args":[{"ctype":"variable","stack":[{"ctype":"number","value":{"real":-5.269207787345638e+72,"imag":6.672049355733727e+72}}],"name":"z"},{"ctype":"number","value":{"real":0,"imag":0}}]},{"ctype":"function","oper":"repeat$2","args":[{"ctype":"number","value":{"real":8,"imag":0}},{"ctype":"infix","oper":"=","args":[{"ctype":"variable","stack":[{"ctype":"number","value":{"real":-5.269207787345638e+72,"imag":6.672049355733727e+72}}],"name":"z"},{"ctype":"function","oper":"f$2","args":[{"ctype":"variable","stack":[{"ctype":"number","value":{"real":-5.269207787345638e+72,"imag":6.672049355733727e+72}}],"name":"z"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"c"}],"modifs":{}}]}],"modifs":{}}]},{"ctype":"function","oper":"hue$1","args":[{"ctype":"infix","oper":"/","args":[{"ctype":"function","oper":"arctan2$2","args":[{"ctype":"function","oper":"re$1","args":[{"ctype":"variable","stack":[{"ctype":"number","value":{"real":-5.269207787345638e+72,"imag":6.672049355733727e+72}}],"name":"z"}],"modifs":{}},{"ctype":"function","oper":"im$1","args":[{"ctype":"variable","stack":[{"ctype":"number","value":{"real":-5.269207787345638e+72,"imag":6.672049355733727e+72}}],"name":"z"}],"modifs":{}}],"modifs":{}},{"ctype":"variable","stack":[{"ctype":"number","value":{"real":3.141592653589793,"imag":0}}],"name":"pi"}]}],"modifs":{}}]},"arglist":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"c"}]}};

myfunctions = {"#drawgrid$1":{"oper":"#drawgrid$1","body":{"ctype":"infix","oper":";","args":[{"ctype":"infix","oper":";","args":[{"ctype":"infix","oper":";","args":[{"ctype":"infix","oper":";","args":[{"ctype":"infix","oper":";","args":[{"ctype":"infix","oper":";","args":[{"ctype":"infix","oper":";","args":[{"ctype":"infix","oper":";","args":[{"ctype":"infix","oper":";","args":[{"ctype":"infix","oper":";","args":[{"ctype":"infix","oper":";","args":[{"ctype":"function","oper":"regional$7","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"b"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"xmin"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"xmax"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ymin"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ymax"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"nx"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ny"}],"modifs":{}},{"ctype":"infix","oper":"=","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"b"},{"ctype":"function","oper":"screenbounds$0","args":[],"modifs":{}}]}]},{"ctype":"infix","oper":"=","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"xmin"},{"ctype":"infix","oper":"-","args":[{"ctype":"infix","oper":"_","args":[{"ctype":"infix","oper":"_","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"b"},{"ctype":"number","value":{"real":4,"imag":0}}]},{"ctype":"number","value":{"real":1,"imag":0}}]},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]}]}]},{"ctype":"infix","oper":"=","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"xmax"},{"ctype":"infix","oper":"+","args":[{"ctype":"infix","oper":"_","args":[{"ctype":"infix","oper":"_","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"b"},{"ctype":"number","value":{"real":2,"imag":0}}]},{"ctype":"number","value":{"real":1,"imag":0}}]},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]}]}]},{"ctype":"infix","oper":"=","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ymin"},{"ctype":"infix","oper":"-","args":[{"ctype":"infix","oper":"_","args":[{"ctype":"infix","oper":"_","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"b"},{"ctype":"number","value":{"real":4,"imag":0}}]},{"ctype":"number","value":{"real":2,"imag":0}}]},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]}]}]},{"ctype":"infix","oper":"=","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ymax"},{"ctype":"infix","oper":"+","args":[{"ctype":"infix","oper":"_","args":[{"ctype":"infix","oper":"_","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"b"},{"ctype":"number","value":{"real":2,"imag":0}}]},{"ctype":"number","value":{"real":2,"imag":0}}]},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]}]}]},{"ctype":"infix","oper":"=","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"nx"},{"ctype":"function","oper":"round$1","args":[{"ctype":"infix","oper":"/","args":[{"ctype":"infix","oper":"-","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"xmax"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"xmin"}]},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]}],"modifs":{}}]}]},{"ctype":"infix","oper":"=","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ny"},{"ctype":"function","oper":"round$1","args":[{"ctype":"infix","oper":"/","args":[{"ctype":"infix","oper":"-","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ymax"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ymin"}]},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]}],"modifs":{}}]}]},{"ctype":"infix","oper":"=","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"xmin"},{"ctype":"infix","oper":"*","args":[{"ctype":"function","oper":"floor$1","args":[{"ctype":"infix","oper":"/","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"xmin"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]}],"modifs":{}},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]}]}]},{"ctype":"infix","oper":"=","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ymin"},{"ctype":"infix","oper":"*","args":[{"ctype":"function","oper":"floor$1","args":[{"ctype":"infix","oper":"/","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ymin"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]}],"modifs":{}},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]}]}]},{"ctype":"function","oper":"repeat$3","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"nx"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"x"},{"ctype":"infix","oper":";","args":[{"ctype":"function","oper":"draw$2","args":[{"ctype":"function","oper":"genList","args":[{"ctype":"infix","oper":"+","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"xmin"},{"ctype":"infix","oper":"*","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"x"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]}]},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ymin"}],"modifs":{}},{"ctype":"function","oper":"genList","args":[{"ctype":"infix","oper":"+","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"xmin"},{"ctype":"infix","oper":"*","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"x"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]}]},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ymax"}],"modifs":{}}],"modifs":{"color":{"ctype":"infix","oper":"*","args":[{"ctype":"function","oper":"genList","args":[{"ctype":"number","value":{"real":1,"imag":0}},{"ctype":"number","value":{"real":1,"imag":0}},{"ctype":"number","value":{"real":1,"imag":0}}],"modifs":{}},{"value":{"real":0.9,"imag":0},"ctype":"number"}]},"size":{"ctype":"number","value":{"real":1,"imag":0}}}},{"ctype":"void"}]}],"modifs":{}}]},{"ctype":"function","oper":"repeat$3","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ny"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"y"},{"ctype":"infix","oper":";","args":[{"ctype":"function","oper":"draw$2","args":[{"ctype":"function","oper":"genList","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"xmin"},{"ctype":"infix","oper":"+","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ymin"},{"ctype":"infix","oper":"*","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"y"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]}]}],"modifs":{}},{"ctype":"function","oper":"genList","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"xmax"},{"ctype":"infix","oper":"+","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"ymin"},{"ctype":"infix","oper":"*","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"y"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]}]}],"modifs":{}}],"modifs":{"color":{"ctype":"infix","oper":"*","args":[{"ctype":"function","oper":"genList","args":[{"ctype":"number","value":{"real":1,"imag":0}},{"ctype":"number","value":{"real":1,"imag":0}},{"ctype":"number","value":{"real":1,"imag":0}}],"modifs":{}},{"value":{"real":0.9,"imag":0},"ctype":"number"}]},"size":{"ctype":"number","value":{"real":1,"imag":0}}}},{"ctype":"void"}]}],"modifs":{}}]},"arglist":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"s"}]},"f$2":{"oper":"f$2","body":{"ctype":"infix","oper":"+","args":[{"ctype":"infix","oper":"*","args":[{"ctype":"variable","stack":[{"ctype":"number","value":{"real":0,"imag":0}}],"name":"z"},{"ctype":"variable","stack":[{"ctype":"number","value":{"real":0,"imag":0}}],"name":"z"}]},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"c"}]},"arglist":[{"ctype":"variable","stack":[{"ctype":"number","value":{"real":0,"imag":0}}],"name":"z"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"c"}]},"mandle$1":{"oper":"mandle$1","body":{"ctype":"infix","oper":";","args":[{"ctype":"infix","oper":";","args":[{"ctype":"infix","oper":";","args":[{"ctype":"infix","oper":"=","args":[{"ctype":"variable","stack":[{"ctype":"number","value":{"real":0,"imag":0}}],"name":"z"},{"ctype":"number","value":{"real":0,"imag":0}}]},{"ctype":"function","oper":"repeat$2","args":[{"ctype":"number","value":{"real":8,"imag":0}},{"ctype":"infix","oper":"=","args":[{"ctype":"variable","stack":[{"ctype":"number","value":{"real":0,"imag":0}}],"name":"z"},{"ctype":"function","oper":"f$2","args":[{"ctype":"variable","stack":[{"ctype":"number","value":{"real":0,"imag":0}}],"name":"z"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"c"}],"modifs":{}}]}],"modifs":{}}]},{"ctype":"function","oper":"hue$1","args":[{"ctype":"infix","oper":"/","args":[{"ctype":"function","oper":"arctan2$2","args":[{"ctype":"function","oper":"re$1","args":[{"ctype":"variable","stack":[{"ctype":"number","value":{"real":0,"imag":0}}],"name":"z"}],"modifs":{}},{"ctype":"function","oper":"im$1","args":[{"ctype":"variable","stack":[{"ctype":"number","value":{"real":0,"imag":0}}],"name":"z"}],"modifs":{}}],"modifs":{}},{"ctype":"variable","stack":[{"ctype":"number","value":{"real":3.141592653589793,"imag":0}}],"name":"pi"}]}],"modifs":{}}]},{"ctype":"void"}]},"arglist":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"c"}]}};

/*
{"f$2":{"oper":"f$2","body":{"ctype":"infix","oper":"+","args":[{"ctype":"infix","oper":"*","args":[{"ctype":"variable","stack":[{"ctype":"number","value":{"real":-2.179962618679341e+208,"imag":5.767460321370287e+208}}],"name":"z"},{"ctype":"variable","stack":[{"ctype":"number","value":{"real":-2.179962618679341e+208,"imag":5.767460321370287e+208}}],"name":"z"}]},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"c"}]},"arglist":[{"ctype":"variable","stack":[{"ctype":"number","value":{"real":-2.179962618679341e+208,"imag":5.767460321370287e+208}}],"name":"z"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"c"}]},"mandle$1":{
  "oper":"mandle$1","body":{"ctype":"infix","oper":";","args":[{"ctype":"infix","oper":";","args":[{"ctype":"infix","oper":"=","args":[{"ctype":"variable","stack":[{"ctype":"number","value":{"real":-2.179962618679341e+208,"imag":5.767460321370287e+208}}],"name":"z"},{"ctype":"number","value":{"real":0,"imag":0}}]},{"ctype":"function","oper":"repeat$2","args":[{"ctype":"number","value":{"real":10,"imag":0}},{"ctype":"infix","oper":"=","args":[{"ctype":"variable","stack":[{"ctype":"number","value":{"real":-2.179962618679341e+208,"imag":5.767460321370287e+208}}],"name":"z"},{"ctype":"function","oper":"f$2","args":[{"ctype":"variable","stack":[{"ctype":"number","value":{"real":-2.179962618679341e+208,"imag":5.767460321370287e+208}}],"name":"z"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"c"}],"modifs":{}}]}],"modifs":{}}]},{"ctype":"function","oper":"hue$1","args":[{"ctype":"function","oper":"arctan2$2","args":[{"ctype":"function","oper":"re$1","args":[{"ctype":"variable","stack":[{"ctype":"number","value":{"real":-2.179962618679341e+208,"imag":5.767460321370287e+208}}],"name":"z"}],"modifs":{}},{"ctype":"function","oper":"im$1","args":[{"ctype":"variable","stack":[{"ctype":"number","value":{"real":-2.179962618679341e+208,"imag":5.767460321370287e+208}}],"name":"z"}],"modifs":{}}],"modifs":{}}],"modifs":{}}]},"arglist":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"c"}]}};
*/
var toyexpr = {"ctype":"function","oper":"mandle$1","args":[{"ctype":"function","oper":"complex$1","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"#"}],"modifs":{}}],"modifs":{}};
var toyexprsin = {"ctype":"function","oper":"sin$1","args":[{"ctype":"infix","oper":"*","args":[{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"#"},{"ctype":"variable","stack":[{"ctype":"undefined"}],"name":"#"}]}],"modifs":{}};


var ifexpr = {"ctype":"function","oper":"if$3","args":[{"ctype":"infix","oper":">","args":[{"ctype":"number","value":{"real":4,"imag":0}},{"ctype":"number","value":{"real":3,"imag":0}}]},{"value":{"real":0.2,"imag":0},"ctype":"number"},{"ctype":"number","value":{"real":1,"imag":0}}],"modifs":{}};


var toyexprwithoutvars = {"ctype":"function","oper":"sqrt$1","args":[{"ctype":"function","oper":"sin$1","args":[{"ctype":"infix","oper":"+","args":[{"ctype":"number","value":{"real":0,"imag":0}},{"ctype":"number","value":{"real":3,"imag":0}}]}],"modifs":{}}],"modifs":{}};

console.log("==========A================");
console.log(typeToString(getType(toyexprwithoutvars,'')));

console.log(typeToString(getType({"ctype":"number","value":{"real":10,"imag":0}},'')));


/*
precompile(toyexpr);

//
//console.log(assigments['']);
console.log(T);

console.log(variables);


console.log(compile(toyexpr, '', true).term);
for(let f in compiledfunctions) {
  console.log(compiledfunctions[f]);
}
*/
console.log("==========================");
console.log(typeToString(getType(
{ ctype: 'void' }), ''));

console.log(typeToString(getType(
{ ctype: 'infix',
  oper: ';',
  args: 
   [ { ctype: 'number', value: {real: 1.2, imag: 0.} },
     { ctype: 'void' } ] }
     
), ''));



console.log("==========================");
console.log(generateColorPlotProgram(toyexprsin));
console.log("==========================");

console.log(compile({"ctype":"number","value":{"real":10,"imag":0}},'',true));
console.log("==========================");
console.log(compile(
{"ctype":"infix","oper":"+","args":[{"ctype":"number","value":{"real":0,"imag":1}},{"ctype":"number","value":{"real":3,"imag":0}}]}
,'',true));
console.log("==========================");

console.log(generateColorPlotProgram(ifexpr));

//console.log(generateColorPlotProgram({"ctype":"number","value":{"real":10,"imag":0}}));

console.log("===========C===============");
console.log(generateColorPlotProgram(toyexpr));

console.log("==========================");
console.log("fertig :)");

//console.log("========Compiling Renderers...==================");
//let r = new Renderer(toyexprsin, 100, 100)
//console.log(r);


